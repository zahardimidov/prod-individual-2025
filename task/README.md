# Backend Рекламная платформа 

## Описание
В IT-индустрии многие компании зарабатывают на рекламе. Раньше реклама существовала только в физическом мире, но за
последние 20 лет она активно перешла в цифровые форматы. Вам предлагается создать стартап, который
будет заниматься показом рекламы и эффективным размещением рекламных объявлений.

Ваша задача — разработать рекламный движок, который будет показывать пользователям наиболее подходящую рекламу,
учитывать запросы партнеров и при этом приносить максимальную прибыль стартапу. Например, если пользователю
доступно несколько рекламных баннеров, нужно отобразить тот, который принесет больше дохода, будет наиболее релевантен
для пользователя и поможет рекламодателю привлечь больше клиентов.

## Обязательные функциональные требования

### Управление данными пользователей и рекламодателей 
Система будет показывать рекламу клиентам, которую будут настраивать и запускать рекламодатели, поэтому необходимо
реализовать возможность регистрировать клиентов и рекламодателей в системе.

Все ID рекламодателей и пользователей задаются из вне системы и должны быть уникальными.

Чтобы стартап был супер крутым, команда организаторов решила немного помочь вам и сделать ML модель, которая
генерирует скоры релевантности конкретного клиента к рекламодателю. ML скор \- это просто целое число по паре значений
client\_id (ID клиента), advertiser\_id (ID рекламодателя), которое чем больше, тем выше релевантность. ML модель
постоянно обновляются, так как в нее поступают свежие данные о действиях клиента, и нам хотелось бы отправлять ML скоры
к вам в систему, но для этого вам необходимо будет реализовать REST API.

Для получения клиентов, рекламодателей и скоров в вашей системе реализуйте REST API со следующими методами:

1. Добавление списка пользователей
2. Добавление списка рекламодателей
3. Получение пользователя по ID
4. Получение рекламодателя по ID
5. Добавление ML скоров по рекламодателям и клиентам

Атрибуты клиента

* ID пользователя UUID
* Логин в системе
* Возраст
* Название локации (метка, которая может быть как городом, регионом, так и небольшим районом, пример “Сахалин”, “Метро
  Белорусская”, “Екатеринбург” и др.)
* Пол

Атрибуты рекламодателя

* ID рекламодателя UUID
* Название

Атрибуты ML скоров

* ID пользователя
* ID рекламодателя
* ML скор

Важно, что все ID пользователей и ID рекламодателей должны быть строго заданы в запросах на добавление.

В методах не нужно реализовывать аутентификацию и авторизацию. В реальных промышленных системах важно было бы сделать и
аутентификацию и авторизацию, но для того, чтобы вы смогли сконцентрироваться на более сложной логике мы опустили этот
функционал.

### Управление рекламными кампаниями (объявлениями) 
В контексте задания рекламные кампании \- это настройки кампании, которую запускает рекламодатель, в настройках он
указывать данные объявления, которые увидит пользователь, когда увидит рекламу.  
У рекламодателя есть возможность создавать, обновлять и удалять рекламные кампании и смотреть все, которые он создал.
Реализуйте REST API, который позволит это делать и будет иметь следующие методы:

* Создание рекламной кампании
* Обновление рекламной кампании
* Получение рекламной кампании по ID
* Получение списка рекламных кампаний с пагинацией
* Удаление рекламной кампании по ID

Он может задавать в кампании следующие настройки:

* количество показов объявления (в момент входа пользователя в приложение ему показывает реклама, это и считает *
  *показом**) Не может меняться после старта рекламной кампании.
* количество переходов по объявлению (в момент, когда пользователь кликает по объявлению, которое ему высветилось
  происходит **переход**). Не может меняться после старта рекламной кампании.
* цену за 1 показ
* цену за 1 переход
* название объявления
* текст рекламного объявления
* дата начала действия включительно. Не может меняться после старта рекламной кампании и не может быть в прошлом, но
  может быть текущим днем
* дата окончания действия включительно. Не может меняться после старта рекламной кампании и не может быть в прошлом, но
  может быть текущим днем

Старт рекламной кампании означает, что текущая дата в системе больше либо равна дате начала рекламной кампании.
Окончание рекламной кампании означает, что текущая дата в системе больше даты окончания рекламной кампании.

В методах создания и обновления необходимо возвращать данные по созданному или обновленному рекламному объявлению.

Рекламные объявления могут показываться пользователям, только в даты их действия, которые задаются в настройках.

Важно, что показы и переходы учитываются только по уникальным клиентам, то есть если один клиент посмотрел на объявление
2 раза, то для рекламодателя это 1 показ.

### Настройка таргетирования рекламы
Здорово, что у вас будет умная ML модель, которая выдает релевантность от клиента к рекламодателю, но, как и все ML
алгоритмы, модель работает с определенной точностью и к сожалению не сможет на 100 процентов точно учитывать локацию пол
и возраст клиентов, кроме того ML модель не знает о желаниях рекламодателя например запустить рекламу только на
определенный район или город или только на мужчин или женщин.

Для этого необходимо добавить возможность таргетирования по клиентским данным: пол, возраст и локация. Добавьте в ваш
методы создания и обновления рекламной кампании возможность указания таргетирования.

Атрибуты таргетирования

* пол \- (MALE, FEMALE, ALL)
* возраст от которого показывать объявления (включительно)
* возраст до которого показывать объявления (включительно)
* локация \- метка локации, клиенты которой должны иметь возможность видеть объявление. По факту это просто строка,
  например Moscow или metroBelarusskaya. То есть если ключен таргетинг объявления по локации, то это объявление могут
  видеть только те клиенты, у которых эта метка location полностью совпадает с меткой location из рекламного объявления

Учитывайте атрибуты клиента при показе рекламы, сопоставляя с параметрами таргетирования из настроек кампании.

При указании таргетирования в настройках рекламного объявления необходимо показывать объявление только тем клиентам, у
которых возраст попадает в допустимые границы, локация полностью совпадает и пол попадает под возможный.

### Показ рекламных объявлений пользователям  
Как только пользователь заходит в какое-нибудь место в приложении, UI (вымышленный) будет вызывать ваш REST endpoint,
который должен будет возвращать объявление, которое будет видеть клиент. Другими словами, вам на вход подается ID клиент
и вам необходимо вернуть для него рекламное объявление, которое он должен увидеть, с учетом настроек, которые ввел
рекламодатель. Какое именно рекламное объявление вернуть решаете только вы и ваш алгоритм.

Показать рекламу на первый взгляд очень просто, но хочется сделать
алгоритм, который сможет зарабатывать больше денег, чем рекламные движки конкурентов и при этом показывать релевантную
рекламу пользователям, а также удовлетворять требования рекламодателей.

### Отображение статистики по объявлениям и клиентам  
Все предыдущие фичи позволяют пользователям получать классную релевантную рекламу, а рекламодателям приходить к вам и
закупать рекламу. Но, как и в любом процессе хочется иметь понимаем что в нем происходит. Например, вы заказываете пиццу и
хотите знать какой там сейчас статус заказа, она еще готовится или ее еще не начала готовиться, возможно ее везет курьер
и т.д.. Подобно этому ваши рекламодатели хотят знать сколько человек посмотрели рекламу, а сколько человек перешли, как
эти показы и переходы выглядят в каждый отдельный день и др.

Ваша задача сделать API для получения такой информативной статистики. Важно чтобы статистика показывала общие значения
по каждому отдельному рекламному объявлению, метрики по всем рекламным объявлениям сразу, метрики по каждому дню в
разрезе отдельного объявления, так и всех вместе.

Реализуйте следующие API методы

* Получение статистики по ID рекламному объявлению
* Получение статистики по всем рекламным объявлениям рекламодателя.
* Получение ежедневной статистики по ID рекламного объявления
* Получение ежедневной статистики по всем рекламным объявлениям рекламодателя

Атрибуты статистики:

* Количество показов
* Количество переходов
* Конверсия из показа в переход (Количество переходов / Количество показов \* 100%)
* Сумма денег, потраченная на показы
* Сумма денег, потраченная на переходы
* Сумма денег, потраченная всего

Атрибуты ежедневной статистики абсолютно такие же, но возвращаются в виде массива, с добавленным полем даты, за которую
собралась статистика.

Небольшая подсказка. Помните что в рамках рекламной кампании рекламодатель может увеличить или уменьшить ставку за клик,
поэтому учитывайте это в статистике.

## Опциональные функциональные требования
Для дальнейшего развития проекта и развития вашей креативности и навыков предлагаем вам реализовать опциональные
требования. Здесь почти нет четких правил и ограничений, главное — чтобы все запускалось в docker-compose и проверяющие
могли это оценить.

### Настройка изображений в рекламных объявлениях
Чтобы клиенты охотнее переходили по рекламным объявлениям, здорово было бы добавить в него изображение. Придумайте
возможность добавления изображения в рекламное объявление и то, как и где вы будете его хранить. Для добавления данной
функциональности можно добавлять в контракт методов работы с рекламными объявлениями новые поля, но удалять старые
запрещено. Также можете добавить новые методы для работы с изображениями.

### Визуализация статистики 
Вы разрабатываете backend-приложение, но круто было бы визуализировать статистику. Для этого предлагаем вам поднять в
docker-compose средство визуализации данных, например Grafana или apache superset, и настроить в нем дашборды для
визуализации аналитики. Какие графики строить — решать вам.

### Интеграция с telegram ботом  
Вы разработали стартап, но нужно ждать коллег фронтендеров, когда они смогут написать UI для нашего крутого бэка. Но, чтобы получить инвестиции, вы могли бы сделать telegram-бота, который интегрировался бы с вашим приложением, и
рекламодатели могли бы смотреть, создавать и обновлять рекламные кампании через него, а также смотреть статистику.

### Модерация текстов рекламных кампаний 
Предположим, что все круто и инкубатор PROD и инвесторы дали вам денег на масштабирование. Но вы этого, к сожалению,
делать не можете, ведь какой-нибудь злой рекламодатель напишет в рекламном тексте матерные слова и у вас будут
репутационные проблемы. Для этого реализуйте модерацию в вашей платформе рекламы.

### Интеграция с LLM для генерации рекламных текстов 
У вас уже есть ML-модель от оргов. Но сейчас почти все стартапы любят добавлять слово AI, поэтому и вы не хотите
отставать от тренда и решили сделать суперфичу, чтобы рекламодатель мог сгенерировать текст рекламного объявления
исходя из его названия и названия рекламодателя через LLM. Предлагаем вам реализовать такую вот фичу